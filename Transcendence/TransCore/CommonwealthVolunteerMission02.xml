<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>

	<MissionType UNID="&msCMVolunteer02;"
			name=				"Commonwealth Volunteer 02: Destroy Enemy Station"
			attributes=			"commonwealthMilitia, commonwealthVolunteer, metropolisMilitia, rank0"
			inherit=			"&baDestroyStationMission;"

			level=				"1-8"
			maxAppearing=		"3-5"
			>
		<Properties>
			<Variant id="character.missionGiver">
				&chEnricoGaul;
			</Variant>
			<Data id="reward"></Data>
			<Variant id="targetDesc">
				{
					criteria: "TAE +populated; -questTarget; -uncharted;"
					}
			</Variant>
		</Properties>

		<Events>
			<OnTargetChosen>
				(block (
					(targetObj (@ gData 'targetObj))

					;	The reward for the station is half of the standard
					;	treasure value for the station.

					(rewardExact (/ (obj@ targetObj 'stdTreasure) 2))

					;	Round it to the nearest 100

					(reward (max 100 (* 100 (round (/ rewardExact 100)))))
					)
					(dbgOutput "Reward: " reward)
					(msnSet@ gSource 'reward reward)
					)
			</OnTargetChosen>
		</Events>
		
		<Language>
			<Text id="Name">
				Destroy Threat to Metropolis
			</Text>
			<Text id="Summary">
				(msnTranslate gSource 'textSummary {
					targetName: (objGetName (objGetObjByID (msn@ gSource 'targetID)) 'article)
					reward: (fmtCurrency 'credit (msn@ gSource 'reward))
					systemName: (sysGetName)
					})
			</Text>
			<Text id="Intro">
				(typTranslate (msn@ gSource 'character.missionGiver) 'missionIntro {
					missionObj: gSource
					})
			</Text>
			<Text id="Briefing">
				(msnTranslate gSource (cat 'textBriefing. (min (+ (msn@ gSource 'missionNumber) 1) 3)) {
					targetName: (objGetName (objGetObjByID (msn@ gSource 'targetID)) 'article)
					reward: (fmtCurrency 'credit (msn@ gSource 'reward))
					})
			</Text>
			<Text id="AcceptReply">
				(block (
					(targetObj (objGetObjByID (msn@ gSource 'targetID)))
					(targetCR (obj@ targetObj 'challengeRating))
					(systemCR (sys@ 'stdChallengeRating))
					)
					(switch
						(gr targetCR systemCR)
							(msnTranslate gSource 'textAcceptReply.hard {
								})

						(ls targetCR systemCR)
							(msnTranslate gSource 'textAcceptReply.easy {
								})

						(msnTranslate gSource 'textAcceptReply.normal {
							})
						)
					)
			</Text>
			<Text id="DeclineReply">
				(msnTranslate gSource 'textDeclineReply1 {
					})
			</Text>
			<Text id="InProgress">
				(msnTranslate gSource 'textInProgress1 {
					})
			</Text>
			<Text id="SuccessDebrief">
				(msnTranslate gSource 'textSuccessDebrief1 {
					reward: (fmtCurrency 'credit (msn@ gSource 'reward))
					})
			</Text>
			<Text id="FailureDebrief">
				(msnTranslate gSource 'textFailureDebrief1 {
					})
			</Text>

			<Text id="textSummary">
			
				%TargetName% is preying on vulnerable citizens in the system.
				Your mission is to destroy the station.

				System: %systemName%\n
				Payment: %reward%

			</Text>
			<Text id="textBriefing.1">

				The gray-haired man stares at you then shakes his head.

				"All right, %boy%. I hope you can handle this.

				"There's %targetName% in the system, and the station council has
				grown a backbone and decided to act. I've been authorized to 
				deal with the threat, which means I'm authorizing you to blow
				it to hell.

				"We'll pay %reward% if you succeed. Clear?"

			</Text>
			<Text id="textBriefing.2">

				Captain Gaul chuckles.

				"Well it's your lucky day! The station council is cleaning up 
				the system. Must be an election coming up.

				"There's %targetName% in the system and I want you to go in and
				destroy it. Go ahead, make a mess if necessary.

				"We'll pay %reward% if you succeed. Clear?"

			</Text>
			<Text id="textBriefing.3">

				Captain Gaul scoffs.

				"All right, I forgot how much you hate banter.

				"Let me get to the point: We've got %targetName% in the system
				and I've been authorized to take it out. I want you to go out 
				there and destroy it.

				"We'll pay %reward% if you succeed. Clear?"

			</Text>
			<Text id="textAcceptReply.normal">

				"All right. I'll send the target to your computer. Be careful,
				OK? These guys are not gonna make it easy for you.

				"OK, get out of here."

			</Text>
			<Text id="textAcceptReply.easy">

				"All right. I'll send the target to your computer. Don't worry
				about these guys&mdash;you can handle them. But don't get 
				careless either.

				"OK, get out of here."

			</Text>
			<Text id="textAcceptReply.hard">

				Captain Gaul nods, then looks you in the eyes.

				"Listen, %name%, these guys are the real deal. They're 
				experienced, and they're well-armed. Go in strong and keep
				blasting until they're done.

				"But be careful. If your armor takes a beating, get out of 
				there. You're no good to me if you're dead.

				"OK, get out of here."

			</Text>
			<Text id="textDeclineReply1">

				"Ah, Hell! What are you doing here then? Stop wasting my time!"

			</Text>
			<Text id="textInProgress1">

				"What's wrong? You said you could handle this mission! Get back 
				out there and finish the job!"

			</Text>
			<Text id="textSuccessDebrief1">

				The gray-haired man leans back on his chair.

				"Good. A nice clean hit. That'll send a message.

				"We've deposited %reward% to your account."

			</Text>
			<Text id="textFailureDebrief1">

				The gray-haired man shouts as you enter:

				"What the kack are you doing? We're all alone out here, and if 
				we don't stand up to these blowholes they're gonna own the whole
				system.

				"Next time act like you actually care!"

			</Text>
			<Text id="SuccessMsg">
				Mission complete!
			</Text>
		</Language>
	</MissionType>

</TranscendenceModule>
